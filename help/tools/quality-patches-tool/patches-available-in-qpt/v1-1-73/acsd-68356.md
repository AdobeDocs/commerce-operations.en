---
title: 'ACSD-68356: [!DNL GraphQL] cart query returns incorrect discount amount for virtual quotes'
description: Apply the ACSD-68356 patch to fix the Adobe Commerce issue where [!DNL GraphQL] cart query returns incorrect discount amount for virtual quotes.
feature: Checkout, GraphQL
role: Admin, Developer
type: Troubleshooting
---
# ACSD-68356: [!DNL GraphQL] cart query returns incorrect discount amount for virtual quotes 

The ACSD-68356 patch fixes the issue where [!DNL GraphQL] cart query returns incorrect discount amount for virtual quotes. This patch is available when the [[!DNL Quality Patches Tool (QPT)]](/help/tools/quality-patches-tool/quality-patches-tool-to-self-serve-quality-patches.md) 1.1.73 is installed. The patch ID is ACSD-68356. Please note that this issue is scheduled to be fixed in Adobe Commerce 2.4.9.

## Affected products and versions

**The patch is created for Adobe Commerce version:**

* Adobe Commerce (all deployment methods) 2.4.8-p2

**Compatible with Adobe Commerce versions:**

* Adobe Commerce (all deployment methods) 2.4.8 - 2.4.8-p3

>[!NOTE]
>
>The patch might become applicable to other versions with new [!DNL Quality Patches Tool] releases. To check if the patch is compatible with your Adobe Commerce version, update the `magento/quality-patches` package to the latest version and check the compatibility on the [[!DNL Quality Patches Tool]: Search for patches page](https://experienceleague.adobe.com/tools/commerce-quality-patches/index.html). Use the patch ID as a search keyword to locate the patch.

## Issue

[!DNL GraphQL] cart queries return incorrect discount amounts for virtual quotes, applying discounts to ineligible virtual products.

<u>Steps to reproduce</u>:

1. Create two virtual products:  
   1. `virtual1` SKU
   1. `virtual2` SKU
1. Create a cart price rule:
   1. Set to apply automatically, without a coupon.
   1. Actions: 
    1. Percent of product price discount - 20%.
    1. Applies only to cart items where SKU is `virtual2`.
1. Add products to a fresh, empty, quote through storefront:
   1. Add `virtual1` SKU first.
   1. Add `virtual2` SKU second.
1. Get cart details using the following [!DNL GraphQL] query:
   
   ```
   {
     cart(cart_id: "cart_id") {
       email
       itemsV2 {
         total_count
         items {
           uid
           prices {
             total_item_discount {
               value
             }
             price {
               value
             }
             discounts {
               label
               amount {
                 value
               }
             }
           }
           product {
             name
             sku
           }
           quantity
         },
         page_info {
             page_size
             current_page
             total_pages
         }
       }
       applied_coupons {
         code
       }
       prices {
         discounts {
           amount {
             value
           }
           applied_to
           label
         }
         grand_total {
           value
         }
       }
     }
   }
   ```

1. Check **[!UICONTROL cart]** > **[!UICONTROL items]** > **[!UICONTROL prices]** > **[!UICONTROL discounts]**.

<u>Expected results</u>:

* `virtual1` SKU has no discount listed in [!DNL GraphQL]
* `virtual2` SKU has discount listed in [!DNL GraphQL]

<u>Actual results</u>:

* Both `virtual1` and `virtual2` display identical discounts in the [!DNL GraphQL] response.

## Apply the patch

To apply individual patches, use the following links depending on your deployment method:

* Adobe Commerce or Magento Open Source on-premises: [[!DNL Quality Patches Tool] > Usage](/help/tools/quality-patches-tool/usage.md) in the [!DNL Quality Patches Tool] guide.
* Adobe Commerce on cloud infrastructure: [Upgrades and Patches > Apply Patches](https://experienceleague.adobe.com/docs/commerce-cloud-service/user-guide/develop/upgrade/apply-patches.html) in the Commerce on Cloud Infrastructure guide.

## Related reading

To learn more about [!DNL Quality Patches Tool], refer to:

* [[!DNL Quality Patches Tool]: A self-service tool for quality patches](/help/tools/quality-patches-tool/quality-patches-tool-to-self-serve-quality-patches.md) in the Tools guide.
