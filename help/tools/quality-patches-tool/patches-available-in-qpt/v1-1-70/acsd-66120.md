---
title: 'ACSD-66120: [!DNL GraphQL] displays incorrect discount percentages and base prices when catalog prices include tax'
description: Apply the ACSD-66120 patch to fix the Adobe Commerce issue where [!DNL GraphQL] incorrectly displays discount percentages and base prices when catalog prices are configured to include tax. This issue caused rounding discrepancies, such as showing a 19.99% discount instead of the expected 20%.
feature: GraphQL
role: Admin, Developer
type: Troubleshooting
---

# ACSD-66120: [!DNL GraphQL] displays incorrect discount percentages and base prices when catalog prices include tax

The ACSD-66120 patch fixes the issue where [!DNL GraphQL] incorrectly displays discount percentages and base prices when catalog prices are configured to include tax. This issue caused rounding discrepancies, such as showing a 19.99% discount instead of the expected 20%. This patch is available when the [[!DNL Quality Patches Tool (QPT)]](/help/tools/quality-patches-tool/quality-patches-tool-to-self-serve-quality-patches.md) 1.1.70 is installed. The patch ID is ACSD-66120. Please note that this issue is scheduled to be fixed in Adobe Commerce 2.4.9.

## Affected products and versions

**The patch is created for Adobe Commerce version:**

* Adobe Commerce (all deployment methods) 2.4.6-p9

**Compatible with Adobe Commerce versions:**

* Adobe Commerce (all deployment methods) 2.4.4 - 2.4.8-p2

>[!NOTE]
>
>The patch might become applicable to other versions with new [!DNL Quality Patches Tool] releases. To check if the patch is compatible with your Adobe Commerce version, update the `magento/quality-patches` package to the latest version and check the compatibility on the [[!DNL Quality Patches Tool]: Search for patches page](https://experienceleague.adobe.com/tools/commerce-quality-patches/index.html). Use the patch ID as a search keyword to locate the patch.

## Issue

GraphQL incorrectly displays discount percentages and base prices when catalog prices are configured to include tax. Due to rounding errors, the discount percentage shows as 19.99% instead of the configured 20%.

<u>Steps to reproduce</u>:

1. Go to **[!UICONTROL Stores]** > **[!UICONTROL Settings]** > **[!UICONTROL Configuration]** > **[!UICONTROL Catalog]** > **[!UICONTROL Catalog]** > **[!UICONTROL Price]**.
1. Set **[!UICONTROL Catalog Price Scope]** to *Website*.
1. Go to **[!UICONTROL Stores]** > **[!UICONTROL Settings]** > **[!UICONTROL Configuration]** > **[!UICONTROL Sales]** > **[!UICONTROL Tax]** > **[!UICONTROL Calculation Settings]**.
    1. Set **[!UICONTROL Tax Calculation Method Based On]** to *Unit Price*.
    1. Set **[!UICONTROL Catalog Prices]** to *Including Tax*.
    1. Set **[!UICONTROL Apply Discount On Prices]** to *Including Tax*.
1. Go to **[!UICONTROL Stores]** > **[!UICONTROL Settings]** > **[!UICONTROL Configuration]** > **[!UICONTROL Sales]** > **[!UICONTROL Tax]** > **[!UICONTROL Default Tax Destination Calculation]**.
    1. Set **[!UICONTROL Default Country]** to *France*.
1. Go to **[!UICONTROL Stores]** > **[!UICONTROL Tax Zones and Rates]** > **[!UICONTROL Add new Tax Rate]**.
    1. Set **[!UICONTROL Tax Identifier]** to Any name.
    1. Set **[!UICONTROL Zip/Post Code]** to ***.
    1. Set **[!UICONTROL Country]** to *France*.
    1. Set **[!UICONTROL Rate Percent]** to *20.000000*.
    1. Click **[!UICONTROL Save]**.
1. Go to **[!UICONTROL Stores]** > **[!UICONTROL Tax Rules]** > **[!UICONTROL Add new Tax Rule]**
    1. Set **[!UICONTROL Name]** to any name.
    1. Set **[!UICONTROL Tax Rate]** to rate added in previous step.
1. Go to **[!UICONTROL Catalog]** > **[!UICONTROL Products]** > **[!UICONTROL Add Product]**
    1. Set **[!UICONTROL Product Name]** to *test*.
    1. Set **[!UICONTROL SKU]** to *test*.
    1. Set **[!UICONTROL Price]** to *82.65*.
    1. Set **[!UICONTROL Tax Class]** to *Taxable Goods*.
    1. Set **[!UICONTROL Quantity]** to *100*.
    1. Click **[!UICONTROL Save]**.
1. Change scope to *Default Store View*
    1. Unset "Use Default Value" on Price
    1. Set Price: 68.87
    1. Unset "Use Default Value" on Tax Class
    1. Set Tax Class: Taxable goods 
    1. Save
1. Go to *Marketing > Promotions > Catalog Price Rule*
    1. Add new Rule: any name
    1. Active: yes
    1. Website: Main Website
    1. Customer Groups: all
    1. Add Action: Apply as percentage of original
    1. Discount Amount: 20.000000
    1. save
1. Perform full reindex

```
$ bin/magento index:reindex
```

1. Perform GraphQL call:

```
query{
products(filter: {sku: {eq: "test"}}, sort: {name: ASC}) {
    items {
      name
      sku
      price_range {
        minimum_price {
          regular_price {
            value
            currency
          }
          final_price {
            value
            currency
          }
          discount {
            amount_off
            percent_off
          }
        }
        maximum_price {
          regular_price {
            value
            currency
          }
          final_price {
            value
            currency
          }
          discount {
            amount_off
            percent_off
          }
        }
      }
    }
  }
}
  
```

with Store: default in Headers

<u>Expected results</u>:

Discount percentage should be exactly as configured in the Catalog Price Rule - 20%

<u>Actual results</u>:

Discount is calculated as 19.99%

## Apply the patch

To apply individual patches, use the following links depending on your deployment method:

* Adobe Commerce or Magento Open Source on-premises: [[!DNL Quality Patches Tool] > Usage](/help/tools/quality-patches-tool/usage.md) in the [!DNL Quality Patches Tool] guide.
* Adobe Commerce on cloud infrastructure: [Upgrades and Patches > Apply Patches](https://experienceleague.adobe.com/docs/commerce-cloud-service/user-guide/develop/upgrade/apply-patches.html) in the Commerce on Cloud Infrastructure guide.

## Related reading

To learn more about [!DNL Quality Patches Tool], refer to:

* [[!DNL Quality Patches Tool]: A self-service tool for quality patches](/help/tools/quality-patches-tool/quality-patches-tool-to-self-serve-quality-patches.md) in the Tools guide.
